# storage/documents におけるモデル別精度比較

- 対象ドキュメント: `数学ノート01`（`storage/documents/*_source.jpeg` を参照）
- すべて同じ 1 ページ PDF を入力し、`storage/documents/*.md` に生成結果を保存
- 目的: 各モデルに共通する代数式の転記ミスを洗い出し、差異を比較

## 基準となる正しい式
- (1) `(a + c)(a + 1) = a^2 + a + ac + c`
- (2) `(x + 4)(x - 2) - (x - 3)^2 = 8x - 17`
- (3) `(a + b + c)(a - b + c) - (a + b - c)(a - b - c) = 4ac`
- (4) `2x^2 - 8x - 64 = 2(x + 4)(x - 8)`
- (5) `(2x + 3)(2x - 3) - (x - 1)(3x + 1) = x^2 + 2x - 8`
- (6) `x^2 - 2x - y + x = x^2 - x - y`
- (7) `a^2 - b^2 - c^2 - 2ac = a^2 - (b^2 + 2ac + c^2)`

## Qwen/Qwen3-VL-4B-Instruct
- 該当ファイル: `d1a2c813`, `3bffba2d`, `077be07d`, `403320a9`, `c2a020db`, `46bda398`
- 良かった点: `(a + c)(a + 1)` はすべて正しく `a^2 + a + ac + c` を維持
- 主な誤り:
  - 式 (2) を一律に `8x^2 - 17` と誤記（例: `3bffba2d.md` の 6-8 行目）
  - 式 (4) を `2x^2 - 8x - 64x` と読み替えた結果、因数分解で余計な `y` が混入
  - 式 (6) を `(x + 1)(x - y)` と因数分解し、元式と一致しない展開になる
  - 式 (7) を `(a + b + c)(a - b - c)` と因数分解し、交差項が `-2bc` に変化

## Qwen/Qwen3-VL-4B-Instruct-FP8
- 該当ファイル: `bd64a6f1`, `cca932b8`, `6bd17429`, `1e014ec0`, `e82c29a9`, `faf6ee27`
- 4B 通常版に加えて発生した誤り:
  - `(a + c)(a + 1)` が `a^2a + a + ac + c` のように余分な `a` を含む
  - 式 (4) が `2xy^2 - 8xy - 64x` に変形し、不要な `y` や 2 乗が付く
  - 式 (7) を `a^2 - b^2 - c^2 - 2bc` と誤読し `(a + b + c)(a - b - c)` に因数分解
  - 式 (2)、(6) の誤りは 4B 通常版と同一

## Qwen/Qwen3-VL-8B-Instruct
- 該当ファイル: `8aee31dd`, `3b98a208`, `2cd8f1ed`
- 観察結果:
  - FP8 版で見られた `a^2a` や `2xy^2 - 8xy - 64x` などの誤りをそのまま踏襲
  - `Date | 22.` や `p12 ①` といったフォーマット上のノイズが加わるが内容は改善せず
  - 式 (2)、(6)、(7) の誤った処理も全て継続

## Qwen/Qwen3-VL-8B-Instruct-FP8
- 該当ファイル: `b93f361d`, `bf61d5bf`, `244e72f4`, `11aeec84`
- 8B 通常版と同様に `a^2a`、`xy` の混入、誤因数分解など内容面の違いは見られず
- `p(2) 1` のような書式揺れが増えるが、正確さの向上は確認できない

## モデル横断のまとめ
- 全 20 件で式 (2)(4)(6)(7) の重大な誤りが共通しており、モデルのサイズ変更では改善しなかった
- FP8 量子化版は追加で `a^2a` や `xy` の混入など転記ミスが増える傾向
- 式 (4) の定数 64 は全モデルで `64x` と誤記されており、元ノートでは定数項だった可能性が高い
- プロンプトのチューニングや演算チェックによる後処理など、モデル切り替え以外の対策が必要
